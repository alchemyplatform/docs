TXN:
  title: Transaction
  description: The transaction schema, as it appears inside a block
  oneOf:
    - $ref: "#/components/schemas/INVOKE_TXN"
    - $ref: "#/components/schemas/L1_HANDLER_TXN"
    - $ref: "#/components/schemas/DECLARE_TXN"
    - $ref: "#/components/schemas/DEPLOY_TXN"
    - $ref: "#/components/schemas/DEPLOY_ACCOUNT_TXN"

INVOKE_TXN:
  title: Invoke transaction
  description: Initiate a transaction from an account
  oneOf:
    - $ref: "#/components/schemas/INVOKE_TXN_V0"
    - $ref: "#/components/schemas/INVOKE_TXN_V1"
    - $ref: "#/components/schemas/INVOKE_TXN_V3"

INVOKE_TXN_V0:
  title: Invoke transaction V0
  description: Invokes a specific function in the desired contract (not necessarily an account)
  type: object
  required:
    - type
    - contract_address
    - entry_point_selector
    - calldata
    - max_fee
    - version
    - signature
  properties:
    type:
      title: Type
      type: string
      enum:
        - INVOKE
    max_fee:
      title: Max fee
      $ref: "#/components/schemas/FELT"
      description: The maximal fee that can be charged for including the transaction
    version:
      title: Version
      description: Version of the transaction scheme
      type: string
      enum:
        - "0x0"
        - "0x100000000000000000000000000000000"
    signature:
      title: Signature
      $ref: "#/components/schemas/SIGNATURE"
    contract_address:
      title: Contract address
      $ref: "../_shared/components/base-types.yaml#/components/schemas/ADDRESS"
    entry_point_selector:
      title: Entry point selector
      $ref: "#/components/schemas/FELT"
    calldata:
      title: Calldata
      type: array
      description: The parameters passed to the function
      items:
        $ref: "#/components/schemas/FELT"

INVOKE_TXN_V1:
  title: Invoke transaction V1
  description: Initiates a transaction from a given account
  type: object
  required:
    - type
    - sender_address
    - calldata
    - max_fee
    - version
    - signature
    - nonce
  properties:
    type:
      title: Type
      type: string
      enum:
        - INVOKE
    sender_address:
      title: Sender address
      $ref: "../_shared/components/base-types.yaml#/components/schemas/ADDRESS"
    calldata:
      title: Calldata
      type: array
      description: >
        The data expected by the account's `execute` function
        (in most use cases, this includes the called contract address and a function selector)
      items:
        $ref: "#/components/schemas/FELT"
    max_fee:
      title: Max fee
      $ref: "#/components/schemas/FELT"
      description: The maximal fee that can be charged for including the transaction
    version:
      title: Version
      description: Version of the transaction scheme
      type: string
      enum:
        - "0x1"
        - "0x100000000000000000000000000000001"
    signature:
      title: Signature
      $ref: "#/components/schemas/SIGNATURE"
    nonce:
      title: Nonce
      $ref: "#/components/schemas/FELT"

INVOKE_TXN_V3:
  title: Invoke transaction V3
  description: Initiates a transaction from a given account
  type: object
  required:
    - type
    - sender_address
    - calldata
    - version
    - signature
    - nonce
    - resource_bounds
    - tip
    - paymaster_data
    - account_deployment_data
    - nonce_data_availability_mode
    - fee_data_availability_mode
  properties:
    type:
      title: Type
      type: string
      enum:
        - INVOKE
    sender_address:
      title: Sender address
      $ref: "../_shared/components/base-types.yaml#/components/schemas/ADDRESS"
    calldata:
      title: Calldata
      type: array
      description: >
        The data expected by the account's `execute` function
        (in most use cases, this includes the called contract address and a function selector)
      items:
        $ref: "#/components/schemas/FELT"
    version:
      title: Version
      description: Version of the transaction scheme
      type: string
      enum:
        - "0x3"
        - "0x100000000000000000000000000000003"
    signature:
      title: Signature
      $ref: "#/components/schemas/SIGNATURE"
    nonce:
      title: Nonce
      $ref: "#/components/schemas/FELT"
    resource_bounds:
      title: Resource bounds
      description: Resource bounds for the transaction execution
      $ref: "#/components/schemas/RESOURCE_BOUNDS_MAPPING"
    tip:
      title: Tip
      $ref: "#/components/schemas/u64"
      description: The tip for the transaction
    paymaster_data:
      title: Paymaster data
      type: array
      items:
        $ref: "#/components/schemas/FELT"
      description: Data needed to allow the paymaster to pay for the transaction in native tokens
    account_deployment_data:
      title: Account deployment data
      type: array
      items:
        $ref: "#/components/schemas/FELT"
      description: Data needed to deploy the account contract from which this transaction will be initiated
    nonce_data_availability_mode:
      title: Nonce DA mode
      description: >
        The storage domain of the account's nonce (an account has a nonce per DA mode)
      $ref: "#/components/schemas/DA_MODE"
    fee_data_availability_mode:
      title: Fee DA mode
      description: >
        The storage domain of the account's balance from which the fee will be charged
      $ref: "#/components/schemas/DA_MODE"

DECLARE_TXN:
  title: Declare transaction
  oneOf:
    - $ref: "#/components/schemas/DECLARE_TXN_V0"
    - $ref: "#/components/schemas/DECLARE_TXN_V1"
    - $ref: "#/components/schemas/DECLARE_TXN_V2"
    - $ref: "#/components/schemas/DECLARE_TXN_V3"

DECLARE_TXN_V0:
  title: Declare Contract Transaction V0
  description: Declare Contract Transaction V0
  type: object
  required:
    - type
    - sender_address
    - max_fee
    - version
    - signature
    - class_hash
  properties:
    type:
      title: Declare
      type: string
      enum:
        - DECLARE
    sender_address:
      title: Sender address
      description: >
        The address of the account contract sending the declaration transaction
      $ref: "../_shared/components/base-types.yaml#/components/schemas/ADDRESS"
    max_fee:
      title: Max fee
      $ref: "#/components/schemas/FELT"
      description: The maximal fee that can be charged for including the transaction
    version:
      title: Version
      description: Version of the transaction scheme
      type: string
      enum:
        - "0x0"
        - "0x100000000000000000000000000000000"
    signature:
      title: Signature
      $ref: "#/components/schemas/SIGNATURE"
    class_hash:
      title: Class hash
      description: The hash of the declared class
      $ref: "#/components/schemas/FELT"

DECLARE_TXN_V1:
  title: Declare Contract Transaction V1
  description: Declare Contract Transaction V1
  type: object
  required:
    - type
    - sender_address
    - max_fee
    - version
    - signature
    - nonce
    - class_hash
  properties:
    type:
      title: Declare
      type: string
      enum:
        - DECLARE
    sender_address:
      title: Sender address
      description: >
        The address of the account contract sending the declaration transaction
      $ref: "../_shared/components/base-types.yaml#/components/schemas/ADDRESS"
    max_fee:
      title: Max fee
      $ref: "#/components/schemas/FELT"
      description: The maximal fee that can be charged for including the transaction
    version:
      title: Version
      description: Version of the transaction scheme
      type: string
      enum:
        - "0x1"
        - "0x100000000000000000000000000000001"
    signature:
      title: Signature
      $ref: "#/components/schemas/SIGNATURE"
    nonce:
      title: Nonce
      $ref: "#/components/schemas/FELT"
    class_hash:
      title: Class hash
      description: The hash of the declared class
      $ref: "#/components/schemas/FELT"

DECLARE_TXN_V2:
  title: Declare Transaction V2
  description: Declare Contract Transaction V2
  type: object
  required:
    - type
    - sender_address
    - compiled_class_hash
    - max_fee
    - version
    - signature
    - nonce
    - class_hash
  properties:
    type:
      title: Declare
      type: string
      enum:
        - DECLARE
    sender_address:
      title: Sender address
      description: >
        The address of the account contract sending the declaration transaction
      $ref: "../_shared/components/base-types.yaml#/components/schemas/ADDRESS"
    compiled_class_hash:
      title: Compiled class hash
      description: The hash of the Cairo assembly resulting from the Sierra compilation
      $ref: "#/components/schemas/FELT"
    max_fee:
      title: Max fee
      $ref: "#/components/schemas/FELT"
      description: The maximal fee that can be charged for including the transaction
    version:
      title: Version
      description: Version of the transaction scheme
      type: string
      enum:
        - "0x2"
        - "0x100000000000000000000000000000002"
    signature:
      title: Signature
      $ref: "#/components/schemas/SIGNATURE"
    nonce:
      title: Nonce
      $ref: "#/components/schemas/FELT"
    class_hash:
      title: Class hash
      description: The hash of the declared class
      $ref: "#/components/schemas/FELT"

DECLARE_TXN_V3:
  title: Declare Transaction V3
  description: Declare Contract Transaction V3
  type: object
  required:
    - type
    - sender_address
    - compiled_class_hash
    - version
    - signature
    - nonce
    - class_hash
    - resource_bounds
    - tip
    - paymaster_data
    - account_deployment_data
    - nonce_data_availability_mode
    - fee_data_availability_mode
  properties:
    type:
      title: Declare
      type: string
      enum:
        - DECLARE
    sender_address:
      title: Sender address
      description: >
        The address of the account contract sending the declaration transaction
      $ref: "../_shared/components/base-types.yaml#/components/schemas/ADDRESS"
    compiled_class_hash:
      title: Compiled class hash
      description: The hash of the Cairo assembly resulting from the Sierra compilation
      $ref: "#/components/schemas/FELT"
    version:
      title: Version
      description: Version of the transaction scheme
      type: string
      enum:
        - "0x3"
        - "0x100000000000000000000000000000003"
    signature:
      title: Signature
      $ref: "#/components/schemas/SIGNATURE"
    nonce:
      title: Nonce
      $ref: "#/components/schemas/FELT"
    class_hash:
      title: Class hash
      description: The hash of the declared class
      $ref: "#/components/schemas/FELT"
    resource_bounds:
      title: Resource bounds
      description: Resource bounds for the transaction execution
      $ref: "#/components/schemas/RESOURCE_BOUNDS_MAPPING"
    tip:
      title: Tip
      $ref: "#/components/schemas/u64"
      description: The tip for the transaction
    paymaster_data:
      title: Paymaster data
      type: array
      items:
        $ref: "#/components/schemas/FELT"
      description: Data needed to allow the paymaster to pay for the transaction in native tokens
    account_deployment_data:
      title: Account deployment data
      type: array
      items:
        $ref: "#/components/schemas/FELT"
      description: Data needed to deploy the account contract from which this transaction will be initiated
    nonce_data_availability_mode:
      title: Nonce DA mode
      description: >
        The storage domain of the account's nonce (an account has a nonce per DA mode)
      $ref: "#/components/schemas/DA_MODE"
    fee_data_availability_mode:
      title: Fee DA mode
      description: >
        The storage domain of the account's balance from which the fee will be charged
      $ref: "#/components/schemas/DA_MODE"

DEPLOY_ACCOUNT_TXN:
  title: Deploy Account Transaction
  description: Deploys an account contract
  type: object
  required:
    - version
    - signature
    - nonce
    - type
    - contract_address_salt
    - constructor_calldata
    - class_hash
    - max_fee
  properties:
    version:
      title: Version
      description: Version of the transaction scheme
      type: string
      enum:
        - "0x1"
        - "0x100000000000000000000000000000001"
    signature:
      title: Signature
      $ref: "#/components/schemas/SIGNATURE"
    nonce:
      title: Nonce
      $ref: "#/components/schemas/FELT"
    type:
      title: Type
      type: string
      enum:
        - DEPLOY_ACCOUNT
    contract_address_salt:
      title: Contract address salt
      description: The salt for the address of the deployed contract
      $ref: "#/components/schemas/FELT"
    constructor_calldata:
      title: Constructor calldata
      type: array
      description: The parameters passed to the constructor
      items:
        $ref: "#/components/schemas/FELT"
    class_hash:
      title: Class hash
      description: The hash of the deployed contract's class
      $ref: "#/components/schemas/FELT"
    max_fee:
      title: Max fee
      $ref: "#/components/schemas/FELT"
      description: The maximal fee that can be charged for including the transaction

DEPLOY_TXN:
  title: Deploy Contract Transaction
  description: >
    The structure of a deploy transaction. Note that this transaction type is deprecated
    and will no longer be supported in future versions
  type: object
  required:
    - version
    - type
    - constructor_calldata
    - contract_address_salt
    - class_hash
  properties:
    version:
      title: Version
      description: Version of the transaction scheme
      $ref: "#/components/schemas/FELT"
    type:
      title: Deploy
      type: string
      enum:
        - DEPLOY
    contract_address_salt:
      title: Contract address salt
      description: The salt for the address of the deployed contract
      $ref: "#/components/schemas/FELT"
    constructor_calldata:
      title: Constructor calldata
      type: array
      description: The parameters passed to the constructor
      items:
        $ref: "#/components/schemas/FELT"
    class_hash:
      title: Class hash
      description: The hash of the deployed contract's class
      $ref: "#/components/schemas/FELT"

L1_HANDLER_TXN:
  title: L1 Handler Transaction
  description: >
    A call to an l1_handler on an L2 contract induced by a message from L1
  allOf:
    - type: object
      required:
        - version
        - type
        - nonce
      properties:
        version:
          title: Version
          description: Version of the transaction scheme
          type: string
          enum:
            - "0x0"
        type:
          title: Type
          type: string
          enum:
            - L1_HANDLER
        nonce:
          title: Nonce
          description: >
            The L1->L2 message nonce field of the SN Core L1 contract at the time the transaction was sent
          $ref: "#/components/schemas/NUM_AS_HEX"
    - $ref: "#/components/schemas/FUNCTION_CALL"

BROADCASTED_TXN:
  title: Broadcasted transaction
  description: A transaction that has been broadcasted to the network
  oneOf:
    - $ref: "#/components/schemas/BROADCASTED_INVOKE_TXN"
    - $ref: "#/components/schemas/BROADCASTED_DECLARE_TXN"
    - $ref: "#/components/schemas/BROADCASTED_DEPLOY_ACCOUNT_TXN"

BROADCASTED_INVOKE_TXN:
  title: Broadcasted invoke transaction
  description: A transaction that has been broadcasted to the network
  allOf:
    - $ref: "#/components/schemas/INVOKE_TXN"

BROADCASTED_DECLARE_TXN:
  title: Broadcasted declare transaction
  description: A transaction that has been broadcasted to the network
  oneOf:
    - $ref: "#/components/schemas/BROADCASTED_DECLARE_TXN_V1"
    - $ref: "#/components/schemas/BROADCASTED_DECLARE_TXN_V2"
    - $ref: "#/components/schemas/BROADCASTED_DECLARE_TXN_V3"

BROADCASTED_DECLARE_TXN_V1:
  title: Broadcasted declare transaction V1
  description: A transaction that has been broadcasted to the network
  allOf:
    - $ref: "#/components/schemas/DECLARE_TXN_V1"

BROADCASTED_DECLARE_TXN_V2:
  title: Broadcasted declare transaction V2
  description: A transaction that has been broadcasted to the network
  allOf:
    - $ref: "#/components/schemas/DECLARE_TXN_V2"

BROADCASTED_DECLARE_TXN_V3:
  title: Broadcasted declare transaction V3
  description: A transaction that has been broadcasted to the network
  allOf:
    - $ref: "#/components/schemas/DECLARE_TXN_V3"

BROADCASTED_DEPLOY_ACCOUNT_TXN:
  title: Broadcasted deploy account transaction
  description: A transaction that has been broadcasted to the network
  allOf:
    - $ref: "#/components/schemas/DEPLOY_ACCOUNT_TXN"
